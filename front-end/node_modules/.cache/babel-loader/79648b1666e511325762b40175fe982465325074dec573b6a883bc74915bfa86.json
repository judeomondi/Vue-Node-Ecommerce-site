{"ast":null,"code":"import NotFoundPage from '@/pages/NotFoundPage.vue';\nimport axios from 'axios';\nimport { getAuth, sendSignInLinkToEmail, isSignInWithEmailLink, signInWithEmailLink } from 'firebase/auth';\nexport default {\n  name: \"ProductDetailPage\",\n  data() {\n    return {\n      product: {},\n      cartItems: []\n    };\n  },\n  props: ['user'],\n  computed: {\n    itemsInCart() {\n      return this.cartItems.some(item => item.id === this.$route.params.productId);\n    }\n  },\n  watch: {\n    async user(newUserValue) {\n      if (newUserValue) {\n        const cartItemResponse = await axios.get(`/api/users/${newUserValue.uid}/cart`);\n        const cartItems = cartItemResponse.data;\n        this.cartItems = cartItems;\n      }\n    }\n  },\n  methods: {\n    async addToCart() {\n      await axios.post('/api/users/12345/cart', {\n        id: this.$route.params.productId\n      });\n      alert('Successfully added product to cart!');\n    },\n    async signIn() {\n      const email = prompt('Enter your email to sign in');\n      const auth = getAuth();\n      const actionCodeSettings = {\n        url: `https://two-trees-deployment.onrender.com/product/${this.$route.params.productId}`,\n        handleCodeInApp: true\n      };\n      await sendSignInLinkToEmail(auth, email, actionCodeSettings);\n      alert('A login link has been sent to your email');\n      window.localStorage.setItem('emailToSignIn', email);\n    }\n  },\n  components: {\n    NotFoundPage\n  },\n  async created() {\n    const auth = getAuth();\n    if (isSignInWithEmailLink(auth, window.location.href)) {\n      const email = window.localStorage.getItem('emailToSignIn');\n      await signInWithEmailLink(auth, email, window.location.href);\n      alert('Successfully signed in!');\n      window.localStorage.removeItem('emailToSignIn');\n    }\n    const response = await axios.get(`/api/product/${this.$route.params.productId}`);\n    const product = response.data;\n    this.product = product;\n    if (this.user) {\n      const cartItemResponse = await axios.get(`/api/users/${this.user.uid}/cart`);\n      const cartItems = cartItemResponse.data;\n      this.cartItems = cartItems;\n    }\n  }\n};","map":{"version":3,"names":["NotFoundPage","axios","getAuth","sendSignInLinkToEmail","isSignInWithEmailLink","signInWithEmailLink","name","data","product","cartItems","props","computed","itemsInCart","some","item","id","$route","params","productId","watch","user","newUserValue","cartItemResponse","get","uid","methods","addToCart","post","alert","signIn","email","prompt","auth","actionCodeSettings","url","handleCodeInApp","window","localStorage","setItem","components","created","location","href","getItem","removeItem","response"],"sources":["/Users/jude.omondi/Documents/MyProjects/VueProjects/E-commerce-Site/front-end/src/pages/ProductDetailPage.vue"],"sourcesContent":["<template>\n  <div v-if=\"product\">\n    <div class=\"img-wrap\">\n    <img :src=\"product.imageUrl\"/>\n    </div>\n\n    <div class=\"product-details\">\n      <h1>{{ product.name }}</h1>\n      <h3 class=\"price\">{{ product.price }}</h3>\n      <button @click=\"addToCart\" class=\"add-to-cart\" v-if=\"user && !itemsInCart\"> Add to cart</button>\n      <button class=\"grey-button\" v-if=\"user && itemsInCart\">Item Already In Cart</button>\n      <button class=\"sign-in\" @click=\"signIn\" v-if=\"!user\">Sign in with email to add to cart</button>\n    </div>\n  </div>\n\n  <div v-else>\n\n    <NotFoundPage/>\n\n  </div>\n  \n</template>\n\n<script>\nimport NotFoundPage from '@/pages/NotFoundPage.vue';\nimport axios from 'axios';\nimport {getAuth, sendSignInLinkToEmail, isSignInWithEmailLink, signInWithEmailLink} from 'firebase/auth';\n\n\nexport default {\n    name: \"ProductDetailPage\",\n    data() {\n        return {\n            product: {},\n            cartItems: []\n        };\n    },\n    props: ['user'],\n    computed: {\n        itemsInCart(){\n          return this.cartItems.some(item => item.id === this.$route.params.productId);\n        }\n    },\n    watch: {\n      async user(newUserValue) {\n        if(newUserValue){\n        const cartItemResponse = await axios.get(`/api/users/${newUserValue.uid}/cart`);\n        const cartItems = cartItemResponse.data;\n        this.cartItems = cartItems;\n        }\n      }\n    },\n    methods: {\n        async addToCart (){\n          await axios.post('/api/users/12345/cart', {id: this.$route.params.productId});\n          alert ('Successfully added product to cart!');\n        },\n        async signIn(){\n          const email = prompt('Enter your email to sign in');\n          const auth = getAuth();\n          const actionCodeSettings = {\n            url: `https://two-trees-deployment.onrender.com/product/${this.$route.params.productId}`,\n            handleCodeInApp: true\n          }\n          await sendSignInLinkToEmail(auth, email, actionCodeSettings);\n          alert('A login link has been sent to your email');\n          window.localStorage.setItem('emailToSignIn', email);\n        }\n    },\n    components: { NotFoundPage },\n    async created(){\n\n      const auth = getAuth();\n      if(isSignInWithEmailLink(auth, window.location.href)){\n        const email = window.localStorage.getItem('emailToSignIn');\n        await signInWithEmailLink(auth, email, window.location.href);\n        alert('Successfully signed in!');\n        window.localStorage.removeItem('emailToSignIn');\n      }\n\n\n      const response = await axios.get(`/api/product/${this.$route.params.productId}`);\n      const product = response.data;\n      this.product = product;\n\n      if(this.user){\n        const cartItemResponse = await axios.get(`/api/users/${this.user.uid}/cart`);\n        const cartItems = cartItemResponse.data;\n        this.cartItems = cartItems;\n      }\n    }\n}\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}